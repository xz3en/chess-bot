// Ported from https://github.com/discordjs/discord.js/blob/master/src/util/BitField.js
/** Bit Field utility to work with Bits and Flags */ export class BitField {
    #flags = {};
    bitfield;
    constructor(flags, bits){
        this.#flags = flags;
        this.bitfield = BitField.resolve(this.#flags, bits);
    }
    any(bit) {
        return (this.bitfield & BitField.resolve(this.#flags, bit)) !== 0n;
    }
    equals(bit) {
        return this.bitfield === BitField.resolve(this.#flags, bit);
    }
    has(bit, ..._) {
        if (Array.isArray(bit)) return bit.every((p)=>this.has(p));
        bit = BitField.resolve(this.#flags, bit);
        return (this.bitfield & bit) === bit;
    }
    missing(bits, ...hasParams) {
        if (!Array.isArray(bits)) bits = new BitField(this.#flags, bits).toArray(false);
        return bits.filter((p)=>!this.has(p, ...hasParams));
    }
    freeze() {
        return Object.freeze(this);
    }
    add(...bits) {
        let total = 0n;
        for (const bit of bits){
            total |= BitField.resolve(this.#flags, bit);
        }
        if (Object.isFrozen(this)) return new BitField(this.#flags, this.bitfield | total);
        this.bitfield |= total;
        return this;
    }
    remove(...bits) {
        let total = 0n;
        for (const bit of bits){
            total |= BitField.resolve(this.#flags, bit);
        }
        if (Object.isFrozen(this)) return new BitField(this.#flags, this.bitfield & ~total);
        this.bitfield &= ~total;
        return this;
    }
    flags() {
        return this.#flags;
    }
    serialize(...hasParams) {
        const serialized = {};
        for (const [flag, bit] of Object.entries(this.#flags))serialized[flag] = this.has(BitField.resolve(this.#flags, bit), ...hasParams);
        return serialized;
    }
    toArray(...hasParams) {
        return Object.keys(this.#flags).filter((bit)=>this.has(BitField.resolve(this.#flags, bit), ...hasParams));
    }
    toJSON() {
        return this.bitfield.toString();
    }
    valueOf() {
        return this.bitfield;
    }
    *[Symbol.iterator]() {
        yield* this.toArray();
    }
    static resolve(flags, bit = 0n) {
        if (typeof bit === 'bigint') return bit;
        if (typeof bit === 'string' && !isNaN(parseInt(bit))) return BigInt(bit);
        if (typeof bit === 'number' && bit >= 0) return BigInt(bit);
        if (bit instanceof BitField) return this.resolve(flags, bit.bitfield);
        if (Array.isArray(bit)) return bit.map((p)=>this.resolve(flags, p)).reduce((prev, p)=>prev | p, 0n);
        if (typeof bit === 'string' && typeof flags[bit] !== 'undefined') return BigInt(flags[bit]);
        const error = new RangeError('BITFIELD_INVALID');
        throw error;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3gvaGFybW9ueUB2Mi45LjAvc3JjL3V0aWxzL2JpdGZpZWxkLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFBvcnRlZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9kaXNjb3JkanMvZGlzY29yZC5qcy9ibG9iL21hc3Rlci9zcmMvdXRpbC9CaXRGaWVsZC5qc1xuZXhwb3J0IHR5cGUgQml0RmllbGRSZXNvbHZhYmxlID1cbiAgfCBudW1iZXJcbiAgfCBudW1iZXJbXVxuICB8IEJpdEZpZWxkXG4gIHwgc3RyaW5nXG4gIHwgc3RyaW5nW11cbiAgfCBCaXRGaWVsZFtdXG4gIHwgYmlnaW50XG4gIHwgYmlnaW50W11cblxuLyoqIEJpdCBGaWVsZCB1dGlsaXR5IHRvIHdvcmsgd2l0aCBCaXRzIGFuZCBGbGFncyAqL1xuZXhwb3J0IGNsYXNzIEJpdEZpZWxkIHtcbiAgI2ZsYWdzOiB7IFtuYW1lOiBzdHJpbmddOiBudW1iZXIgfCBiaWdpbnQgfSA9IHt9XG4gIGJpdGZpZWxkOiBiaWdpbnRcblxuICBjb25zdHJ1Y3RvcihcbiAgICBmbGFnczogeyBbbmFtZTogc3RyaW5nXTogbnVtYmVyIHwgYmlnaW50IH0sXG4gICAgYml0czogQml0RmllbGRSZXNvbHZhYmxlXG4gICkge1xuICAgIHRoaXMuI2ZsYWdzID0gZmxhZ3NcbiAgICB0aGlzLmJpdGZpZWxkID0gQml0RmllbGQucmVzb2x2ZSh0aGlzLiNmbGFncywgYml0cylcbiAgfVxuXG4gIGFueShiaXQ6IEJpdEZpZWxkUmVzb2x2YWJsZSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAodGhpcy5iaXRmaWVsZCAmIEJpdEZpZWxkLnJlc29sdmUodGhpcy4jZmxhZ3MsIGJpdCkpICE9PSAwblxuICB9XG5cbiAgZXF1YWxzKGJpdDogQml0RmllbGRSZXNvbHZhYmxlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuYml0ZmllbGQgPT09IEJpdEZpZWxkLnJlc29sdmUodGhpcy4jZmxhZ3MsIGJpdClcbiAgfVxuXG4gIGhhcyhiaXQ6IEJpdEZpZWxkUmVzb2x2YWJsZSwgLi4uXzogdW5rbm93bltdKTogYm9vbGVhbiB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYml0KSlcbiAgICAgIHJldHVybiAoYml0LmV2ZXJ5IGFzIHVua25vd25bXVsnZXZlcnknXSkoKHApID0+XG4gICAgICAgIHRoaXMuaGFzKHAgYXMgQml0RmllbGRSZXNvbHZhYmxlKVxuICAgICAgKVxuICAgIGJpdCA9IEJpdEZpZWxkLnJlc29sdmUodGhpcy4jZmxhZ3MsIGJpdClcbiAgICByZXR1cm4gKHRoaXMuYml0ZmllbGQgJiBiaXQpID09PSBiaXRcbiAgfVxuXG4gIG1pc3NpbmcoXG4gICAgYml0czogQml0RmllbGRSZXNvbHZhYmxlLFxuICAgIC4uLmhhc1BhcmFtczogdW5rbm93bltdXG4gICk6IEJpdEZpZWxkUmVzb2x2YWJsZVtdIHtcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkoYml0cykpXG4gICAgICBiaXRzID0gbmV3IEJpdEZpZWxkKHRoaXMuI2ZsYWdzLCBiaXRzKS50b0FycmF5KGZhbHNlKVxuICAgIHJldHVybiAoYml0cyBhcyB1bmtub3duW10pLmZpbHRlcihcbiAgICAgIChwKSA9PiAhdGhpcy5oYXMocCBhcyBCaXRGaWVsZFJlc29sdmFibGUsIC4uLmhhc1BhcmFtcylcbiAgICApIGFzIEJpdEZpZWxkUmVzb2x2YWJsZVtdXG4gIH1cblxuICBmcmVlemUoKTogUmVhZG9ubHk8Qml0RmllbGQ+IHtcbiAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZSh0aGlzKVxuICB9XG5cbiAgYWRkKC4uLmJpdHM6IEJpdEZpZWxkUmVzb2x2YWJsZVtdKTogQml0RmllbGQge1xuICAgIGxldCB0b3RhbCA9IDBuXG4gICAgZm9yIChjb25zdCBiaXQgb2YgYml0cykge1xuICAgICAgdG90YWwgfD0gQml0RmllbGQucmVzb2x2ZSh0aGlzLiNmbGFncywgYml0KVxuICAgIH1cbiAgICBpZiAoT2JqZWN0LmlzRnJvemVuKHRoaXMpKVxuICAgICAgcmV0dXJuIG5ldyBCaXRGaWVsZCh0aGlzLiNmbGFncywgdGhpcy5iaXRmaWVsZCB8IHRvdGFsKVxuICAgIHRoaXMuYml0ZmllbGQgfD0gdG90YWxcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgcmVtb3ZlKC4uLmJpdHM6IEJpdEZpZWxkUmVzb2x2YWJsZVtdKTogQml0RmllbGQge1xuICAgIGxldCB0b3RhbCA9IDBuXG4gICAgZm9yIChjb25zdCBiaXQgb2YgYml0cykge1xuICAgICAgdG90YWwgfD0gQml0RmllbGQucmVzb2x2ZSh0aGlzLiNmbGFncywgYml0KVxuICAgIH1cbiAgICBpZiAoT2JqZWN0LmlzRnJvemVuKHRoaXMpKVxuICAgICAgcmV0dXJuIG5ldyBCaXRGaWVsZCh0aGlzLiNmbGFncywgdGhpcy5iaXRmaWVsZCAmIH50b3RhbClcbiAgICB0aGlzLmJpdGZpZWxkICY9IH50b3RhbFxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICBmbGFncygpOiB7IFtuYW1lOiBzdHJpbmddOiBiaWdpbnQgfCBudW1iZXIgfSB7XG4gICAgcmV0dXJuIHRoaXMuI2ZsYWdzXG4gIH1cblxuICBzZXJpYWxpemUoLi4uaGFzUGFyYW1zOiB1bmtub3duW10pOiB7IFtrZXk6IHN0cmluZ106IGJvb2xlYW4gfSB7XG4gICAgY29uc3Qgc2VyaWFsaXplZDogeyBba2V5OiBzdHJpbmddOiBib29sZWFuIH0gPSB7fVxuICAgIGZvciAoY29uc3QgW2ZsYWcsIGJpdF0gb2YgT2JqZWN0LmVudHJpZXModGhpcy4jZmxhZ3MpKVxuICAgICAgc2VyaWFsaXplZFtmbGFnXSA9IHRoaXMuaGFzKFxuICAgICAgICBCaXRGaWVsZC5yZXNvbHZlKHRoaXMuI2ZsYWdzLCBiaXQpLFxuICAgICAgICAuLi5oYXNQYXJhbXNcbiAgICAgIClcbiAgICByZXR1cm4gc2VyaWFsaXplZFxuICB9XG5cbiAgdG9BcnJheSguLi5oYXNQYXJhbXM6IHVua25vd25bXSk6IHN0cmluZ1tdIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy4jZmxhZ3MpLmZpbHRlcigoYml0KSA9PlxuICAgICAgdGhpcy5oYXMoQml0RmllbGQucmVzb2x2ZSh0aGlzLiNmbGFncywgYml0KSwgLi4uaGFzUGFyYW1zKVxuICAgIClcbiAgfVxuXG4gIHRvSlNPTigpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmJpdGZpZWxkLnRvU3RyaW5nKClcbiAgfVxuXG4gIHZhbHVlT2YoKTogYmlnaW50IHtcbiAgICByZXR1cm4gdGhpcy5iaXRmaWVsZFxuICB9XG5cbiAgKltTeW1ib2wuaXRlcmF0b3JdKCk6IEl0ZXJhdG9yPHN0cmluZz4ge1xuICAgIHlpZWxkKiB0aGlzLnRvQXJyYXkoKVxuICB9XG5cbiAgc3RhdGljIHJlc29sdmUoXG4gICAgZmxhZ3M6IFJlY29yZDxzdHJpbmcsIGJpZ2ludCB8IG51bWJlcj4sXG4gICAgYml0OiBCaXRGaWVsZFJlc29sdmFibGUgPSAwblxuICApOiBiaWdpbnQge1xuICAgIGlmICh0eXBlb2YgYml0ID09PSAnYmlnaW50JykgcmV0dXJuIGJpdFxuICAgIGlmICh0eXBlb2YgYml0ID09PSAnc3RyaW5nJyAmJiAhaXNOYU4ocGFyc2VJbnQoYml0KSkpIHJldHVybiBCaWdJbnQoYml0KVxuICAgIGlmICh0eXBlb2YgYml0ID09PSAnbnVtYmVyJyAmJiBiaXQgPj0gMCkgcmV0dXJuIEJpZ0ludChiaXQpXG4gICAgaWYgKGJpdCBpbnN0YW5jZW9mIEJpdEZpZWxkKSByZXR1cm4gdGhpcy5yZXNvbHZlKGZsYWdzLCBiaXQuYml0ZmllbGQpXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYml0KSlcbiAgICAgIHJldHVybiAoYml0Lm1hcCBhcyB1bmtub3duW11bJ21hcCddKSgocCkgPT5cbiAgICAgICAgdGhpcy5yZXNvbHZlKGZsYWdzLCBwIGFzIEJpdEZpZWxkUmVzb2x2YWJsZSlcbiAgICAgICkucmVkdWNlKChwcmV2OiBiaWdpbnQsIHA6IGJpZ2ludCkgPT4gcHJldiB8IHAsIDBuKVxuICAgIGlmICh0eXBlb2YgYml0ID09PSAnc3RyaW5nJyAmJiB0eXBlb2YgZmxhZ3NbYml0XSAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgICByZXR1cm4gQmlnSW50KGZsYWdzW2JpdF0pXG4gICAgY29uc3QgZXJyb3IgPSBuZXcgUmFuZ2VFcnJvcignQklURklFTERfSU5WQUxJRCcpXG4gICAgdGhyb3cgZXJyb3JcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLHVGQUF1RjtBQVd2RixrREFBa0QsR0FDbEQsT0FBTyxNQUFNO0lBQ1gsQ0FBQyxLQUFLLEdBQXdDLENBQUMsRUFBQztJQUNoRCxTQUFnQjtJQUVoQixZQUNFLEtBQTBDLEVBQzFDLElBQXdCLENBQ3hCO1FBQ0EsSUFBSSxDQUFDLENBQUMsS0FBSyxHQUFHO1FBQ2QsSUFBSSxDQUFDLFFBQVEsR0FBRyxTQUFTLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLEVBQUU7SUFDaEQ7SUFFQSxJQUFJLEdBQXVCLEVBQVc7UUFDcEMsT0FBTyxDQUFDLElBQUksQ0FBQyxRQUFRLEdBQUcsU0FBUyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxFQUFFLElBQUksTUFBTSxFQUFFO0lBQ3BFO0lBRUEsT0FBTyxHQUF1QixFQUFXO1FBQ3ZDLE9BQU8sSUFBSSxDQUFDLFFBQVEsS0FBSyxTQUFTLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLEVBQUU7SUFDekQ7SUFFQSxJQUFJLEdBQXVCLEVBQUUsR0FBRyxDQUFZLEVBQVc7UUFDckQsSUFBSSxNQUFNLE9BQU8sQ0FBQyxNQUNoQixPQUFPLEFBQUMsSUFBSSxLQUFLLENBQXdCLENBQUMsSUFDeEMsSUFBSSxDQUFDLEdBQUcsQ0FBQztRQUViLE1BQU0sU0FBUyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxFQUFFO1FBQ3BDLE9BQU8sQ0FBQyxJQUFJLENBQUMsUUFBUSxHQUFHLEdBQUcsTUFBTTtJQUNuQztJQUVBLFFBQ0UsSUFBd0IsRUFDeEIsR0FBRyxTQUFvQixFQUNE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