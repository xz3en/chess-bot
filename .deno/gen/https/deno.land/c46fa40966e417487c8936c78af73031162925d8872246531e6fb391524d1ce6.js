import { UserFlagsManager } from '../utils/userFlags.ts';
import { SnowflakeBase } from './base.ts';
import { ImageURL } from './cdn.ts';
import { DEFAULT_USER_AVATAR, USER_AVATAR } from '../types/endpoint.ts';
export class User extends SnowflakeBase {
    id;
    username;
    discriminator;
    avatar;
    bot;
    system;
    mfaEnabled;
    locale;
    verified;
    email;
    flags;
    /**
   * Nitro type of the User.
   *
   * 0 = No Nitro
   * 1 = Classic Nitro
   * 2 = Regular Nitro
   */ premiumType;
    publicFlags;
    get tag() {
        return `${this.username}#${this.discriminator}`;
    }
    get nickMention() {
        return `<@!${this.id}>`;
    }
    get mention() {
        return `<@${this.id}>`;
    }
    avatarURL(format = 'png', size = 512) {
        return this.avatar != null ? `${ImageURL(USER_AVATAR(this.id, this.avatar), format, size)}` : this.defaultAvatarURL;
    }
    get defaultAvatarURL() {
        return `${DEFAULT_USER_AVATAR(String(Number(this.discriminator) % 5))}.png`;
    }
    constructor(client, data){
        super(client, data);
        this.id = data.id;
        this.readFromData(data);
    }
    readFromData(data) {
        this.username = data.username ?? this.username;
        this.discriminator = data.discriminator ?? this.discriminator;
        this.avatar = data.avatar ?? this.avatar;
        this.bot = data.bot ?? this.bot;
        this.system = data.system ?? this.system;
        this.mfaEnabled = data.mfa_enabled ?? this.mfaEnabled;
        this.locale = data.locale ?? this.locale;
        this.verified = data.verified ?? this.verified;
        this.email = data.email ?? this.email;
        this.flags = data.flags !== undefined ? new UserFlagsManager(data.flags) : this.flags;
        this.premiumType = data.premium_type ?? this.premiumType;
        this.publicFlags = data.public_flags !== undefined ? new UserFlagsManager(data.public_flags) : this.publicFlags;
    }
    toString() {
        return this.mention;
    }
    async createDM() {
        return this.client.createDM(this);
    }
    async resolveDM() {
        const dmID = await this.client.channels.getUserDM(this.id);
        const dm = (dmID !== undefined ? await this.client.channels.get(dmID) : undefined) ?? await this.createDM().then((chan)=>this.client.channels.setUserDM(this.id, chan.id).then(()=>chan));
        // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion
        return dm;
    }
    async send(content, options) {
        const dm = await this.resolveDM();
        return dm.send(content, options);
    }
}
export class UserResolvable extends SnowflakeBase {
    constructor(client, id){
        super(client);
        this.id = id;
    }
    async get() {
        return this.client.users.get(this.id);
    }
    async fetch() {
        return this.client.users.fetch(this.id);
    }
    async resolve() {
        return this.client.users.resolve(this.id);
    }
    id;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3gvaGFybW9ueUB2Mi45LjAvc3JjL3N0cnVjdHVyZXMvdXNlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IENsaWVudCB9IGZyb20gJy4uL2NsaWVudC9tb2QudHMnXG5pbXBvcnQgdHlwZSB7IFVzZXJQYXlsb2FkIH0gZnJvbSAnLi4vdHlwZXMvdXNlci50cydcbmltcG9ydCB7IFVzZXJGbGFnc01hbmFnZXIgfSBmcm9tICcuLi91dGlscy91c2VyRmxhZ3MudHMnXG5pbXBvcnQgeyBTbm93Zmxha2VCYXNlIH0gZnJvbSAnLi9iYXNlLnRzJ1xuaW1wb3J0IHsgSW1hZ2VVUkwgfSBmcm9tICcuL2Nkbi50cydcbmltcG9ydCB0eXBlIHsgSW1hZ2VTaXplLCBJbWFnZUZvcm1hdHMgfSBmcm9tICcuLi90eXBlcy9jZG4udHMnXG5pbXBvcnQgeyBERUZBVUxUX1VTRVJfQVZBVEFSLCBVU0VSX0FWQVRBUiB9IGZyb20gJy4uL3R5cGVzL2VuZHBvaW50LnRzJ1xuaW1wb3J0IHR5cGUgeyBETUNoYW5uZWwgfSBmcm9tICcuL2RtQ2hhbm5lbC50cydcbmltcG9ydCB7IEFsbE1lc3NhZ2VPcHRpb25zIH0gZnJvbSAnLi90ZXh0Q2hhbm5lbC50cydcbmltcG9ydCB7IE1lc3NhZ2UgfSBmcm9tICcuL21lc3NhZ2UudHMnXG5pbXBvcnQgeyBJUmVzb2x2YWJsZSB9IGZyb20gJy4vcmVzb2x2YWJsZS50cydcblxuZXhwb3J0IGNsYXNzIFVzZXIgZXh0ZW5kcyBTbm93Zmxha2VCYXNlIHtcbiAgaWQ6IHN0cmluZ1xuICB1c2VybmFtZSE6IHN0cmluZ1xuICBkaXNjcmltaW5hdG9yITogc3RyaW5nXG4gIGF2YXRhcj86IHN0cmluZ1xuICBib3Q/OiBib29sZWFuXG4gIHN5c3RlbT86IGJvb2xlYW5cbiAgbWZhRW5hYmxlZD86IGJvb2xlYW5cbiAgbG9jYWxlPzogc3RyaW5nXG4gIHZlcmlmaWVkPzogYm9vbGVhblxuICBlbWFpbD86IHN0cmluZ1xuICBmbGFncyE6IFVzZXJGbGFnc01hbmFnZXJcbiAgLyoqXG4gICAqIE5pdHJvIHR5cGUgb2YgdGhlIFVzZXIuXG4gICAqXG4gICAqIDAgPSBObyBOaXRyb1xuICAgKiAxID0gQ2xhc3NpYyBOaXRyb1xuICAgKiAyID0gUmVndWxhciBOaXRyb1xuICAgKi9cbiAgcHJlbWl1bVR5cGU/OiAwIHwgMSB8IDJcbiAgcHVibGljRmxhZ3MhOiBVc2VyRmxhZ3NNYW5hZ2VyXG5cbiAgZ2V0IHRhZygpOiBzdHJpbmcge1xuICAgIHJldHVybiBgJHt0aGlzLnVzZXJuYW1lfSMke3RoaXMuZGlzY3JpbWluYXRvcn1gXG4gIH1cblxuICBnZXQgbmlja01lbnRpb24oKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYDxAISR7dGhpcy5pZH0+YFxuICB9XG5cbiAgZ2V0IG1lbnRpb24oKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYDxAJHt0aGlzLmlkfT5gXG4gIH1cblxuICBhdmF0YXJVUkwoZm9ybWF0OiBJbWFnZUZvcm1hdHMgPSAncG5nJywgc2l6ZTogSW1hZ2VTaXplID0gNTEyKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5hdmF0YXIgIT0gbnVsbFxuICAgICAgPyBgJHtJbWFnZVVSTChVU0VSX0FWQVRBUih0aGlzLmlkLCB0aGlzLmF2YXRhciksIGZvcm1hdCwgc2l6ZSl9YFxuICAgICAgOiB0aGlzLmRlZmF1bHRBdmF0YXJVUkxcbiAgfVxuXG4gIGdldCBkZWZhdWx0QXZhdGFyVVJMKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGAke0RFRkFVTFRfVVNFUl9BVkFUQVIoU3RyaW5nKE51bWJlcih0aGlzLmRpc2NyaW1pbmF0b3IpICUgNSkpfS5wbmdgXG4gIH1cblxuICBjb25zdHJ1Y3RvcihjbGllbnQ6IENsaWVudCwgZGF0YTogVXNlclBheWxvYWQpIHtcbiAgICBzdXBlcihjbGllbnQsIGRhdGEpXG4gICAgdGhpcy5pZCA9IGRhdGEuaWRcbiAgICB0aGlzLnJlYWRGcm9tRGF0YShkYXRhKVxuICB9XG5cbiAgcmVhZEZyb21EYXRhKGRhdGE6IFVzZXJQYXlsb2FkKTogdm9pZCB7XG4gICAgdGhpcy51c2VybmFtZSA9IGRhdGEudXNlcm5hbWUgPz8gdGhpcy51c2VybmFtZVxuICAgIHRoaXMuZGlzY3JpbWluYXRvciA9IGRhdGEuZGlzY3JpbWluYXRvciA/PyB0aGlzLmRpc2NyaW1pbmF0b3JcbiAgICB0aGlzLmF2YXRhciA9IGRhdGEuYXZhdGFyID8/IHRoaXMuYXZhdGFyXG4gICAgdGhpcy5ib3QgPSBkYXRhLmJvdCA/PyB0aGlzLmJvdFxuICAgIHRoaXMuc3lzdGVtID0gZGF0YS5zeXN0ZW0gPz8gdGhpcy5zeXN0ZW1cbiAgICB0aGlzLm1mYUVuYWJsZWQgPSBkYXRhLm1mYV9lbmFibGVkID8/IHRoaXMubWZhRW5hYmxlZFxuICAgIHRoaXMubG9jYWxlID0gZGF0YS5sb2NhbGUgPz8gdGhpcy5sb2NhbGVcbiAgICB0aGlzLnZlcmlmaWVkID0gZGF0YS52ZXJpZmllZCA/PyB0aGlzLnZlcmlmaWVkXG4gICAgdGhpcy5lbWFpbCA9IGRhdGEuZW1haWwgPz8gdGhpcy5lbWFpbFxuICAgIHRoaXMuZmxhZ3MgPVxuICAgICAgZGF0YS5mbGFncyAhPT0gdW5kZWZpbmVkID8gbmV3IFVzZXJGbGFnc01hbmFnZXIoZGF0YS5mbGFncykgOiB0aGlzLmZsYWdzXG4gICAgdGhpcy5wcmVtaXVtVHlwZSA9IGRhdGEucHJlbWl1bV90eXBlID8/IHRoaXMucHJlbWl1bVR5cGVcbiAgICB0aGlzLnB1YmxpY0ZsYWdzID1cbiAgICAgIGRhdGEucHVibGljX2ZsYWdzICE9PSB1bmRlZmluZWRcbiAgICAgICAgPyBuZXcgVXNlckZsYWdzTWFuYWdlcihkYXRhLnB1YmxpY19mbGFncylcbiAgICAgICAgOiB0aGlzLnB1YmxpY0ZsYWdzXG4gIH1cblxuICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLm1lbnRpb25cbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZURNKCk6IFByb21pc2U8RE1DaGFubmVsPiB7XG4gICAgcmV0dXJuIHRoaXMuY2xpZW50LmNyZWF0ZURNKHRoaXMpXG4gIH1cblxuICBhc3luYyByZXNvbHZlRE0oKTogUHJvbWlzZTxETUNoYW5uZWw+IHtcbiAgICBjb25zdCBkbUlEID0gYXdhaXQgdGhpcy5jbGllbnQuY2hhbm5lbHMuZ2V0VXNlckRNKHRoaXMuaWQpXG4gICAgY29uc3QgZG0gPVxuICAgICAgKGRtSUQgIT09IHVuZGVmaW5lZFxuICAgICAgICA/IGF3YWl0IHRoaXMuY2xpZW50LmNoYW5uZWxzLmdldDxETUNoYW5uZWw+KGRtSUQpXG4gICAgICAgIDogdW5kZWZpbmVkKSA/P1xuICAgICAgKGF3YWl0IHRoaXMuY3JlYXRlRE0oKS50aGVuKChjaGFuKSA9PlxuICAgICAgICB0aGlzLmNsaWVudC5jaGFubmVscy5zZXRVc2VyRE0odGhpcy5pZCwgY2hhbi5pZCkudGhlbigoKSA9PiBjaGFuKVxuICAgICAgKSlcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVubmVjZXNzYXJ5LXR5cGUtYXNzZXJ0aW9uXG4gICAgcmV0dXJuIGRtIVxuICB9XG5cbiAgYXN5bmMgc2VuZChcbiAgICBjb250ZW50OiBzdHJpbmcgfCBBbGxNZXNzYWdlT3B0aW9ucyxcbiAgICBvcHRpb25zPzogQWxsTWVzc2FnZU9wdGlvbnNcbiAgKTogUHJvbWlzZTxNZXNzYWdlPiB7XG4gICAgY29uc3QgZG0gPSBhd2FpdCB0aGlzLnJlc29sdmVETSgpXG4gICAgcmV0dXJuIGRtLnNlbmQoY29udGVudCwgb3B0aW9ucylcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgVXNlclJlc29sdmFibGUgZXh0ZW5kcyBTbm93Zmxha2VCYXNlIGltcGxlbWVudHMgSVJlc29sdmFibGU8VXNlcj4ge1xuICBjb25zdHJ1Y3RvcihjbGllbnQ6IENsaWVudCwgcHVibGljIGlkOiBzdHJpbmcpIHtcbiAgICBzdXBlcihjbGllbnQpXG4gIH1cblxuICBhc3luYyBnZXQoKTogUHJvbWlzZTxVc2VyIHwgdW5kZWZpbmVkPiB7XG4gICAgcmV0dXJuIHRoaXMuY2xpZW50LnVzZXJzLmdldCh0aGlzLmlkKVxuICB9XG5cbiAgYXN5bmMgZmV0Y2goKTogUHJvbWlzZTxVc2VyPiB7XG4gICAgcmV0dXJuIHRoaXMuY2xpZW50LnVzZXJzLmZldGNoKHRoaXMuaWQpXG4gIH1cblxuICBhc3luYyByZXNvbHZlKCk6IFByb21pc2U8VXNlciB8IHVuZGVmaW5lZD4ge1xuICAgIHJldHVybiB0aGlzLmNsaWVudC51c2Vycy5yZXNvbHZlKHRoaXMuaWQpXG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxTQUFTLGdCQUFnQixRQUFRLHdCQUF1QjtBQUN4RCxTQUFTLGFBQWEsUUFBUSxZQUFXO0FBQ3pDLFNBQVMsUUFBUSxRQUFRLFdBQVU7QUFFbkMsU0FBUyxtQkFBbUIsRUFBRSxXQUFXLFFBQVEsdUJBQXNCO0FBTXZFLE9BQU8sTUFBTSxhQUFhO0lBQ3hCLEdBQVU7SUFDVixTQUFpQjtJQUNqQixjQUFzQjtJQUN0QixPQUFlO0lBQ2YsSUFBYTtJQUNiLE9BQWdCO0lBQ2hCLFdBQW9CO0lBQ3BCLE9BQWU7SUFDZixTQUFrQjtJQUNsQixNQUFjO0lBQ2QsTUFBd0I7SUFDeEI7Ozs7OztHQU1DLEdBQ0QsWUFBdUI7SUFDdkIsWUFBOEI7SUFFOUIsSUFBSSxNQUFjO1FBQ2hCLE9BQU8sQ0FBQyxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQztJQUNqRDtJQUVBLElBQUksY0FBc0I7UUFDeEIsT0FBTyxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUN6QjtJQUVBLElBQUksVUFBa0I7UUFDcEIsT0FBTyxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUN4QjtJQUVBLFVBQVUsU0FBdUIsS0FBSyxFQUFFLE9BQWtCLEdBQUcsRUFBVTtRQUNy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