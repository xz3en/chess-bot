export const voiceStateUpdate = async (gateway, d)=>{
    if (d.guild_id === undefined) return;
    const guild = await gateway.client.guilds.get(d.guild_id);
    const voiceState = await guild.voiceStates.get(d.user_id);
    if (d.channel_id === null) {
        if (voiceState === undefined) {
            await guild.members.set(d.user_id, d.member);
            const member = await guild.members.get(d.user_id);
            return gateway.client.emit('voiceStateRemoveUncached', {
                guild,
                member
            });
        }
        // No longer in the channel, so delete
        await guild.voiceStates._delete(d.user_id);
        gateway.client.emit('voiceStateRemove', voiceState);
        return;
    }
    await guild.voiceStates.set(d.user_id, d);
    const newVoiceState = await guild.voiceStates.get(d.user_id);
    if (d.user_id === gateway.client.user.id) {
        gateway.client.voice.emit('voiceStateUpdate', newVoiceState);
    }
    if (voiceState === undefined) {
        gateway.client.emit('voiceStateAdd', newVoiceState);
    } else {
        gateway.client.emit('voiceStateUpdate', voiceState, newVoiceState);
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3gvaGFybW9ueUB2Mi45LjAvc3JjL2dhdGV3YXkvaGFuZGxlcnMvdm9pY2VTdGF0ZVVwZGF0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEd1aWxkIH0gZnJvbSAnLi4vLi4vc3RydWN0dXJlcy9ndWlsZC50cydcbmltcG9ydCB0eXBlIHsgVm9pY2VTdGF0ZSB9IGZyb20gJy4uLy4uL3N0cnVjdHVyZXMvdm9pY2VTdGF0ZS50cydcbmltcG9ydCB0eXBlIHsgTWVtYmVyUGF5bG9hZCB9IGZyb20gJy4uLy4uL3R5cGVzL2d1aWxkLnRzJ1xuaW1wb3J0IHR5cGUgeyBWb2ljZVN0YXRlUGF5bG9hZCB9IGZyb20gJy4uLy4uL3R5cGVzL3ZvaWNlLnRzJ1xuaW1wb3J0IHR5cGUgeyBHYXRld2F5LCBHYXRld2F5RXZlbnRIYW5kbGVyIH0gZnJvbSAnLi4vbW9kLnRzJ1xuXG5leHBvcnQgY29uc3Qgdm9pY2VTdGF0ZVVwZGF0ZTogR2F0ZXdheUV2ZW50SGFuZGxlciA9IGFzeW5jIChcbiAgZ2F0ZXdheTogR2F0ZXdheSxcbiAgZDogVm9pY2VTdGF0ZVBheWxvYWRcbikgPT4ge1xuICBpZiAoZC5ndWlsZF9pZCA9PT0gdW5kZWZpbmVkKSByZXR1cm5cbiAgY29uc3QgZ3VpbGQgPSAoYXdhaXQgZ2F0ZXdheS5jbGllbnQuZ3VpbGRzLmdldChcbiAgICBkLmd1aWxkX2lkXG4gICkpIGFzIHVua25vd24gYXMgR3VpbGRcblxuICBjb25zdCB2b2ljZVN0YXRlID0gYXdhaXQgZ3VpbGQudm9pY2VTdGF0ZXMuZ2V0KGQudXNlcl9pZClcblxuICBpZiAoZC5jaGFubmVsX2lkID09PSBudWxsKSB7XG4gICAgaWYgKHZvaWNlU3RhdGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgYXdhaXQgZ3VpbGQubWVtYmVycy5zZXQoZC51c2VyX2lkLCBkLm1lbWJlciBhcyB1bmtub3duIGFzIE1lbWJlclBheWxvYWQpXG4gICAgICBjb25zdCBtZW1iZXIgPSAoYXdhaXQgZ3VpbGQubWVtYmVycy5nZXQoXG4gICAgICAgIGQudXNlcl9pZFxuICAgICAgKSkgYXMgdW5rbm93biBhcyBNZW1iZXJQYXlsb2FkXG4gICAgICByZXR1cm4gZ2F0ZXdheS5jbGllbnQuZW1pdCgndm9pY2VTdGF0ZVJlbW92ZVVuY2FjaGVkJywgeyBndWlsZCwgbWVtYmVyIH0pXG4gICAgfVxuICAgIC8vIE5vIGxvbmdlciBpbiB0aGUgY2hhbm5lbCwgc28gZGVsZXRlXG4gICAgYXdhaXQgZ3VpbGQudm9pY2VTdGF0ZXMuX2RlbGV0ZShkLnVzZXJfaWQpXG4gICAgZ2F0ZXdheS5jbGllbnQuZW1pdCgndm9pY2VTdGF0ZVJlbW92ZScsIHZvaWNlU3RhdGUgYXMgdW5rbm93biBhcyBWb2ljZVN0YXRlKVxuICAgIHJldHVyblxuICB9XG5cbiAgYXdhaXQgZ3VpbGQudm9pY2VTdGF0ZXMuc2V0KGQudXNlcl9pZCwgZClcbiAgY29uc3QgbmV3Vm9pY2VTdGF0ZSA9IChhd2FpdCBndWlsZC52b2ljZVN0YXRlcy5nZXQoZC51c2VyX2lkKSkhXG5cbiAgaWYgKGQudXNlcl9pZCA9PT0gZ2F0ZXdheS5jbGllbnQudXNlciEuaWQpIHtcbiAgICBnYXRld2F5LmNsaWVudC52b2ljZS5lbWl0KCd2b2ljZVN0YXRlVXBkYXRlJywgbmV3Vm9pY2VTdGF0ZSlcbiAgfVxuXG4gIGlmICh2b2ljZVN0YXRlID09PSB1bmRlZmluZWQpIHtcbiAgICBnYXRld2F5LmNsaWVudC5lbWl0KCd2b2ljZVN0YXRlQWRkJywgbmV3Vm9pY2VTdGF0ZSlcbiAgfSBlbHNlIHtcbiAgICBnYXRld2F5LmNsaWVudC5lbWl0KCd2b2ljZVN0YXRlVXBkYXRlJywgdm9pY2VTdGF0ZSwgbmV3Vm9pY2VTdGF0ZSlcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQU1BLE9BQU8sTUFBTSxtQkFBd0MsT0FDbkQsU0FDQSxJQUNHO0lBQ0gsSUFBSSxFQUFFLFFBQVEsS0FBSyxXQUFXO0lBQzlCLE1BQU0sUUFBUyxNQUFNLFFBQVEsTUFBTSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQzVDLEVBQUUsUUFBUTtJQUdaLE1BQU0sYUFBYSxNQUFNLE1BQU0sV0FBVyxDQUFDLEdBQUcsQ0FBQyxFQUFFLE9BQU87SUFFeEQsSUFBSSxFQUFFLFVBQVUsS0FBSyxJQUFJLEVBQUU7UUFDekIsSUFBSSxlQUFlLFdBQVc7WUFDNUIsTUFBTSxNQUFNLE9BQU8sQ0FBQyxHQUFHLENBQUMsRUFBRSxPQUFPLEVBQUUsRUFBRSxNQUFNO1lBQzNDLE1BQU0sU0FBVSxNQUFNLE1BQU0sT0FBTyxDQUFDLEdBQUcsQ0FDckMsRUFBRSxPQUFPO1lBRVgsT0FBTyxRQUFRLE1BQU0sQ0FBQyxJQUFJLENBQUMsNEJBQTRCO2dCQUFFO2dCQUFPO1lBQU87UUFDekUsQ0FBQztRQUNELHNDQUFzQztRQUN0QyxNQUFNLE1BQU0sV0FBVyxDQUFDLE9BQU8sQ0FBQyxFQUFFLE9BQU87UUFDekMsUUFBUSxNQUFNLENBQUMsSUFBSSxDQUFDLG9CQUFvQjtRQUN4QztJQUNGLENBQUM7SUFFRCxNQUFNLE1BQU0sV0FBVyxDQUFDLEdBQUcsQ0FBQyxFQUFFLE9BQU8sRUFBRTtJQUN2QyxNQUFNLGdCQUFpQixNQUFNLE1BQU0sV0FBVyxDQUFDLEdBQUcsQ0FBQyxFQUFFLE9BQU87SUFFNUQsSUFBSSxFQUFFLE9BQU8sS0FBSyxRQUFRLE1BQU0sQ0FBQyxJQUFJLENBQUUsRUFBRSxFQUFFO1FBQ3pDLFFBQVEsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsb0JBQW9CO0lBQ2hELENBQUM7SUFFRCxJQUFJLGVBQWUsV0FBVztRQUM1QixRQUFRLE1BQU0sQ0FBQyxJQUFJLENBQUMsaUJBQWlCO0lBQ3ZDLE9BQU87UUFDTCxRQUFRLE1BQU0sQ0FBQyxJQUFJLENBQUMsb0JBQW9CLFlBQVk7SUFDdEQsQ0FBQztBQUNILEVBQUMifQ==